<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>d0019R8: Atomic Ref</title>
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in §N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .assertion  for assertions                    (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/******************************************************************************/
/*                                   Body                                     */
/******************************************************************************/

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;               /* limit line length to 50em for readability   */
		margin: 0 auto;                /* center text within page                     */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag     */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		/* Colors */
		color: black;
		background: white top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		color: white;
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		border-color: #c00;
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 2;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
			color: black;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			background: white;
			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;
			background: white;
		}
		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		#toc-nav > a:hover,
		#toc-nav > a:focus {
			background: #f8f8f8;
		}
		#toc-nav > a:not(:hover):not(:focus) {
			color: #707070;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}

		#toc-toggle-inline {
			vertical-align: 0.05em;
			font-size: 80%;
			color: gray;
			color: hsla(203,20%,40%,.7);
			border-style: none;
			background: transparent;
			position: relative;
		}
		#toc-toggle-inline:hover:not(:active),
		#toc-toggle-inline:focus:not(:active) {
			text-shadow: 1px 1px silver;
			top: -1px;
			left: -1px;
		}

		#toc-nav :active {
			color: #C00;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;    /* Inherit the font family. */
		line-height: 1.2;        /* Keep wrapped headings compact */
		hyphens: manual;         /* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		background: transparent;
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	 border-left: 0.5em solid #DEF;
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	  padding: .5em;
	  border: thin solid #ddd; border-radius: .5em;
	  margin: .5em calc(-0.5em - 1px);
	}
	[data-algorithm]:not(.heading) > :first-child {
	  margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	  margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: medium;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		page-break-inside: avoid;
		hyphens: none;
		text-transform: none;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

  /* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		text-decoration: none;
		border-bottom: 1px solid #707070;
		/* Need a bit of extending for it to look okay */
		padding: 0 1px 0;
		margin: 0 -1px 0;
	}
	a:visited {
		border-bottom-color: #BBB;
	}

	/* Use distinguishing colors when user is interacting with the link */
	a[href]:focus,
	a[href]:hover {
		background: #f8f8f8;
		background: rgba(75%, 75%, 75%, .25);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	a[href]:active {
		color: #C00;
		border-color: #C00;
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	/* For autogen numbers, add
	   .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,    .sidefigure img,    figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	.issue,
	.note,
	.example,
	.advisement,
	.assertion,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		text-transform: uppercase;
		color: #AE1E1E;
		padding-right: 1em;
		text-transform: uppercase;
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	   or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		text-transform: uppercase;
		color: #827017;
		min-width: 7.5em;
		display: block;
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	   or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary::before,
	details.note > summary > .marker {
		text-transform: uppercase;
		display: block;
		color: hsl(120, 70%, 30%);
	}
	/* Add .note::before { content: "Note"; } for autogen label,
	   or use class="marker" to mark up the label in source. */

	details.note > summary {
		display: block;
		color: hsl(120, 70%, 30%);
	}
	details.note[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		background: #EEE;
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement > .marker {
		color: #B35F00;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		padding: .75em 1em;
		border: thick red;
		border-style: solid;
		border-radius: 1em;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def           td.footnote {
		padding-top: 0.6em;
	}
	table.def           td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
		 Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding-top: 0.1rem;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Reverse color scheme */
		color: black;
		border-color: #3980B5;
		border-bottom-width: 3px !important;
		margin-bottom: 0px !important;
	}
	.toc a:visited {
		border-color: #054572;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
		line-height: 1.1rem; /* consistent spacing */
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li             { font-weight: bold;   }
	.toc > li li          { font-weight: normal; }
	.toc > li li li       { font-size:   95%;    }
	.toc > li li li li    { font-size:   90%;    }
	.toc > li li li li .secno { font-size: 85%; }
	.toc > li li li li li { font-size:   85%;    }
	.toc > li li li li li .secno { font-size: 100%; }

	/* @supports not (display:grid) { */
		.toc > li             { margin: 1.5rem 0;    }
		.toc > li li          { margin: 0.3rem 0;    }
		.toc > li li li       { margin-left: 2rem;   }

		/* Section numbers in a column of their own */
		.toc .secno {
			float: left;
			width: 4rem;
			white-space: nowrap;
		}

		.toc li {
			clear: both;
		}

		:not(li) > .toc              { margin-left:  5rem; }
		.toc .secno                  { margin-left: -5rem; }
		.toc > li li li .secno       { margin-left: -7rem; }
		.toc > li li li li .secno    { margin-left: -9rem; }
		.toc > li li li li li .secno { margin-left: -11rem; }

		/* Tighten up indentation in narrow ToCs */
		@media (max-width: 30em) {
			:not(li) > .toc              { margin-left:  4rem; }
			.toc .secno                  { margin-left: -4rem; }
			.toc > li li li              { margin-left:  1rem; }
			.toc > li li li .secno       { margin-left: -5rem; }
			.toc > li li li li .secno    { margin-left: -6rem; }
			.toc > li li li li li .secno { margin-left: -7rem; }
		}
	/* } */

	@supports (display:grid) {
		/* Use #toc over .toc to override non-@supports rules. */
		#toc {
			display: grid;
			align-content: start;
			grid-template-columns: auto 1fr;
			grid-column-gap: 1rem;
			column-gap: 1rem;
			grid-row-gap: .6rem;
			row-gap: .6rem;
		}
		#toc h2 {
			grid-column: 1 / -1;
			margin-bottom: 0;
		}
		#toc ol,
		#toc li,
		#toc a {
			display: contents;
			/* Switch <a> to subgrid when supported */
		}
		#toc span {
			margin: 0;
		}
		#toc > .toc > li > a > span {
			/* The spans of the top-level list,
			   comprising the first items of each top-level section. */
			margin-top: 1.1rem;
		}
		#toc .secno {
			grid-column: 1;
			width: auto;
		}
		#toc .content {
			grid-column: 2;
			width: auto;
			margin-right: 1rem;
		}
		#toc .content:hover {
			background: rgba(75%, 75%, 75%, .25);
			border-bottom: 3px solid #054572;
			margin-bottom: -3px;
		}
		#toc li li li .content {
			margin-left: 1rem;
		}
		#toc li li li li .content {
			margin-left: 2rem;
		}
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index       { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li    { margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em }
	ul.index dl    { margin-top: 0; }
	ul.index dt    { margin: .2em 0 .2em 20px;}
	ul.index dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		background: #f7f8f9;
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

/******************************************************************************/
/*                                    Legacy                                  */
/******************************************************************************/

	/* This rule is inherited from past style sheets. No idea what it's for. */
	.hide { display: none }



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-left: calc(13px + 26.5rem - 50vw);
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-left: calc(40em - 50vw) !important;
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-left: 0 !important;
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			 * http://lea.verou.me/2012/04/background-attachment-local/
			 *
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
			            top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
			            top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
<style type="text/css">
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
      vertical-align: top;
    }
    th, td {
      border-left: none;
      border-right: none;
      padding: 0px 10px;
    }
    th {
      text-align: center;
    }
  </style>
  <meta content="Bikeshed version 60c7cf64c0efdd39a8c0261dfad14adb1da62902" name="generator">
  <link href="https://github.com/ORNL/cpp-proposals-pub/blob/master/P0019/P0019r7.html" rel="canonical">
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-hidedel */

            #hidedel:checked ~ del, #hidedel:checked ~ * del { display:none; }
            #hidedel ~ #hidedel-label::before, #hidedel ~ * #hidedel-label::before { content: "☐ "; }
            #hidedel:checked ~ #hidedel-label::before, #hidedel:checked ~ * #hidedel-label::before { content: "☑ "; }
        </style>
<style>/* style-selflinks */

.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: gray;
    color: white;
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: black;
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: #005a9c;
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
<style>/* style-syntax-highlighting */

.highlight:not(.idl) { background: hsl(24, 20%, 95%); }
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
.highlight .c { color: #708090 } /* Comment */
.highlight .k { color: #990055 } /* Keyword */
.highlight .l { color: #000000 } /* Literal */
.highlight .n { color: #0077aa } /* Name */
.highlight .o { color: #999999 } /* Operator */
.highlight .p { color: #999999 } /* Punctuation */
.highlight .cm { color: #708090 } /* Comment.Multiline */
.highlight .cp { color: #708090 } /* Comment.Preproc */
.highlight .c1 { color: #708090 } /* Comment.Single */
.highlight .cs { color: #708090 } /* Comment.Special */
.highlight .kc { color: #990055 } /* Keyword.Constant */
.highlight .kd { color: #990055 } /* Keyword.Declaration */
.highlight .kn { color: #990055 } /* Keyword.Namespace */
.highlight .kp { color: #990055 } /* Keyword.Pseudo */
.highlight .kr { color: #990055 } /* Keyword.Reserved */
.highlight .kt { color: #990055 } /* Keyword.Type */
.highlight .ld { color: #000000 } /* Literal.Date */
.highlight .m { color: #000000 } /* Literal.Number */
.highlight .s { color: #a67f59 } /* Literal.String */
.highlight .na { color: #0077aa } /* Name.Attribute */
.highlight .nc { color: #0077aa } /* Name.Class */
.highlight .no { color: #0077aa } /* Name.Constant */
.highlight .nd { color: #0077aa } /* Name.Decorator */
.highlight .ni { color: #0077aa } /* Name.Entity */
.highlight .ne { color: #0077aa } /* Name.Exception */
.highlight .nf { color: #0077aa } /* Name.Function */
.highlight .nl { color: #0077aa } /* Name.Label */
.highlight .nn { color: #0077aa } /* Name.Namespace */
.highlight .py { color: #0077aa } /* Name.Property */
.highlight .nt { color: #669900 } /* Name.Tag */
.highlight .nv { color: #222222 } /* Name.Variable */
.highlight .ow { color: #999999 } /* Operator.Word */
.highlight .mb { color: #000000 } /* Literal.Number.Bin */
.highlight .mf { color: #000000 } /* Literal.Number.Float */
.highlight .mh { color: #000000 } /* Literal.Number.Hex */
.highlight .mi { color: #000000 } /* Literal.Number.Integer */
.highlight .mo { color: #000000 } /* Literal.Number.Oct */
.highlight .sb { color: #a67f59 } /* Literal.String.Backtick */
.highlight .sc { color: #a67f59 } /* Literal.String.Char */
.highlight .sd { color: #a67f59 } /* Literal.String.Doc */
.highlight .s2 { color: #a67f59 } /* Literal.String.Double */
.highlight .se { color: #a67f59 } /* Literal.String.Escape */
.highlight .sh { color: #a67f59 } /* Literal.String.Heredoc */
.highlight .si { color: #a67f59 } /* Literal.String.Interpol */
.highlight .sx { color: #a67f59 } /* Literal.String.Other */
.highlight .sr { color: #a67f59 } /* Literal.String.Regex */
.highlight .s1 { color: #a67f59 } /* Literal.String.Single */
.highlight .ss { color: #a67f59 } /* Literal.String.Symbol */
.highlight .vc { color: #0077aa } /* Name.Variable.Class */
.highlight .vg { color: #0077aa } /* Name.Variable.Global */
.highlight .vi { color: #0077aa } /* Name.Variable.Instance */
.highlight .il { color: #000000 } /* Literal.Number.Integer.Long */
</style>
 <body class="h-entry">
  <input id="hidedel" style="display:none" type="checkbox">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1 class="p-name no-ref" id="title">d0019R8<br>Atomic Ref</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Draft Proposal, <time class="dt-updated" datetime="2018-06-05">5 June 2018</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://github.com/ORNL/cpp-proposals-pub/blob/master/P0019/P0019r7.html">https://github.com/ORNL/cpp-proposals-pub/blob/master/P0019/P0019r7.html</a>
     <dt>Authors:
     <dd>
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:hedwards@nvidia.com">H. Carter Edwards</a>
     <dd>
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:hboehm@google.com">Hans Boehm</a>
     <dd>
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:ogiroux@nvidia.com">Olivier Giroux</a>
     <dd>
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:dsunder@sandia.gov">Daniel Sunderland</a>
     <dd>
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:mhoemme@sandia.gov">Mark Hoemmen</a>
     <dd>
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:dshollm@sandia.gov">David Hollman</a>
     <dd>
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:blelbach@nvidia.com">Bryce Adelstein Lelbach</a>
     <dd>
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:Jens.Maurer@gmx.net">Jens Maurer</a>
     <dt>Audience:
     <dd>LWG
     <dt>Toggle Diffs:
     <dd>
      <label for="hidedel" id="hidedel-label">Hide deleted text</label>
     <dt>Project:
     <dd>ISO JTC1/SC22/WG21: Programming Language C++
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>Extension to the atomic operations library to allow atomic operations to apply to non-atomic objects.</p>
  </div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#revision-history"><span class="secno">1</span> <span class="content">Revision History</span></a>
    <li><a href="#overview"><span class="secno">2</span> <span class="content">Overview</span></a>
    <li>
     <a href="#motivation"><span class="secno">3</span> <span class="content">Motivation</span></a>
     <ol class="toc">
      <li><a href="#atomic-operations-on-a-single-non-atomic-object"><span class="secno">3.1</span> <span class="content">Atomic Operations on a Single Non-atomic Object</span></a>
      <li><a href="#atomic-operations-on-members-of-a-very-large-array"><span class="secno">3.2</span> <span class="content">Atomic Operations on Members of a Very Large Array</span></a>
     </ol>
    <li><a href="#reference-ability-constraints"><span class="secno">4</span> <span class="content"><em>Reference-ability</em> Constraints</span></a>
    <li><a href="#concern-with-atomict-and-padding-bits-in-t"><span class="secno">5</span> <span class="content">Concern with <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code> and padding bits in <code class="highlight"><span class="n">T</span></code></span></a>
    <li><a href="#naming-atomic-reference-of-t"><span class="secno">6</span> <span class="content">Naming <em>atomic reference of T</em></span></a>
    <li><a href="#future-work"><span class="secno">7</span> <span class="content">Future Work</span></a>
    <li><a href="#proposal"><span class="secno">8</span> <span class="content">Proposal</span></a>
    <li><a href="#test"><span class="secno">9</span> <span class="content">Feature Testing</span></a>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="revision-history"><span class="secno">1. </span><span class="content">Revision History</span><a class="self-link" href="#revision-history"></a></h2>
   <p><span>[P0019r8]</span></p>
   <ul>
    <li data-md="">
     <p><a href="http://wiki.edg.com/bin/view/Wg21rapperswil2018/P0019r7">2018-06-04 Rapperswil SG1</a></p>
     <p>SG1 straw poll to forward to LWG for inclusion in IS20</p>
     <table border="1">
      <tbody>
       <tr>
        <th>SF
        <th>F
        <th>N
        <th>A
        <th>SA
       <tr>
        <td>11 
        <td>14 
        <td>2 
        <td>1 
        <td>1 
     </table>
     <p>SA: Reported that the ThreadSanitizer team potentially opposed this paper</p>
     <ul>
      <li data-md="">
       <p>2018-06-05 ThreadSanitizer team is not opposed, SA would now vote N.</p>
     </ul>
     <p>A: Believes that a TS is a better ship vehicle.</p>
    <li data-md="">
     <p>2018-06-05 SG1</p>
     <p>Concern about atomic_ref of something that is not always lock free</p>
     <p>Consensus for no change. No objections.</p>
    <li data-md="">
     <p><a href="http://wiki.edg.com/bin/view/Wg21rapperswil2018/LWGP0019">2018-06-05 LWG</a></p>
     <p>Many editorial changes requested.</p>
   </ul>
   <p><span>[P0019r7]</span></p>
   <ul>
    <li data-md="">
     <p><a href="http://wiki.edg.com/bin/view/Wg21jacksonville2018/LWGWedPM2">2018-03-15 Jacksonville LWG review</a></p>
    <li data-md="">
     <p>Update to reflect Jacksonville LWG review</p>
    <li data-md="">
     <p>Update to reference resolution of padding bits from <span>[P0528r2]</span></p>
    <li data-md="">
     <p>Add a note clarifying that <code class="highlight"><span class="n">atomic_ref</span></code> might not be lock free
even if <code class="highlight"><span class="n">atomic</span></code> is lock free</p>
    <li data-md="">
     <p>Add wording for all member functions and specializations (in previous version
only the constructor had wording)</p>
    <li data-md="">
     <p>Added reference implementation</p>
    <li data-md="">
     <p>targeted towards IS20</p>
    <li data-md="">
     <p>Convert to bikeshed</p>
   </ul>
   <p><a data-link-type="biblio" href="#biblio-p0019r6">[P0019r6]</a></p>
   <ul>
    <li data-md="">
     <p><a href="http://wiki.edg.com/bin/view/Wg21albuquerque/P0019">2017-11-07 Albuquerque LEWG review</a></p>
     <ul>
      <li data-md="">
       <p>Settle on name <code class="highlight"><span class="n">atomic_ref</span></code></p>
      <li data-md="">
       <p>
        Split out atomic_ref
        <tU0005BU0005D> into a separate paper,
apply editorial changes accordingly</tU0005BU0005D>
       </p>
      <li data-md="">
       <p>Restore copy constructor; not assignment operator</p>
      <li data-md="">
       <p>add <strong>Throws: Nothing</strong> to constructor but do not add noexcept</p>
      <li data-md="">
       <p>Remove <em>wrapping</em> terminology</p>
      <li data-md="">
       <p>Address problem of CAS on <code class="highlight"><span class="n">atomic_ref</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code> where <code class="highlight"><span class="n">T</span></code> is
a struct containing padding bits</p>
      <li data-md="">
       <p>With these revisions move to LWG</p>
     </ul>
   </ul>
   <p><a data-link-type="biblio" href="#biblio-p0019r5">[P0019r5]</a></p>
   <ul>
    <li data-md="">
     <p>2017-03-01 Kona LEWG review</p>
     <ul>
      <li data-md="">
       <p>Merge in P0440 Floating Point Atomic View because LEWG
consensus to move P0020 Floating Point Atomic to C++20 IS</p>
      <li data-md="">
       <p>Rename from <code class="highlight"><span class="n">atomic_view</span></code> and <code class="highlight"><span class="n">atomic_array_view</span></code>;
authors' selection <code class="highlight"><span class="n">atomic_ref</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code> and <code class="highlight"><span class="n">atomic_ref</span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">></span></code>,
other name suggested <code class="highlight"><span class="n">atomic_wrapper</span></code>.</p>
      <li data-md="">
       <p>Remove <code class="highlight"><span class="k">constexpr</span></code> qualification from default constructor
because this qualification constrains implementations and
does not add apparent value.</p>
     </ul>
    <li data-md="">
     <p>Remove default constructor, copy constructor, and assignment operator
for tighter alignment with <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code> and prevent empty references.</p>
    <li data-md="">
     <p>
      Revise syntax to align with <a data-link-type="biblio" href="#biblio-p0558r1">[P0558r1]</a>, Resolving atomic
      <t> base class inconsistencies</t>
     </p>
    <li data-md="">
     <p>Recommend feature next macro</p>
   </ul>
   <p><a data-link-type="biblio" href="#biblio-p0019r4">[P0019r4]</a></p>
   <ul>
    <li data-md="">
     <p>wrapper constructor strengthen requires clause and omit throws clause</p>
    <li data-md="">
     <p>Note types must be trivially copyable, as required for all atomics</p>
    <li data-md="">
     <p>2016-11-09 Issaquah SG1 decision: move to LEWG targeting Concurrency TS V2</p>
   </ul>
   <p><a data-link-type="biblio" href="#biblio-p0019r3">[P0019r3]</a></p>
   <ul>
    <li data-md="">
     <p>Align proposal with content of corresponding sections in N5131, 2016-07-15.</p>
    <li data-md="">
     <p>Remove the <em>one root wrapping constructor</em> requirement from <code class="highlight"><span class="n">atomic_array_view</span></code>.</p>
    <li data-md="">
     <p>Other minor revisions responding to feedback from SG1 @ Oulu.</p>
   </ul>
   <h2 class="heading settled" data-level="2" id="overview"><span class="secno">2. </span><span class="content">Overview</span><a class="self-link" href="#overview"></a></h2>
   <p>This paper proposes an extension to the atomic operations library [<strong>atomics</strong>]
to allow atomic operations to apply to non-atomic objects.  As required by
[<strong>atomics.types.generic</strong>] the value type <strong>T</strong> must be trivially copyable.</p>
   <p>This paper includes <em>atomic floating point</em> capability defined in <a data-link-type="biblio" href="#biblio-p0020r5">[P0020r5]</a>.</p>
   <p><em>Note:</em> A reference implementation](https://github.com/ORNL/cpp-proposals-pub/blob/master/P0019/atomic_ref.hpp)
is available that works on compilers which support the <a href="https://gcc.gnu.org/onlinedocs/gcc/_005f_005fatomic-Builtins.html">GNU atomic builtin</a> functions including recent versions of g++, icpc, and clang++. <em>--end note</em></p>
   <p>This paper is currently targeting C++20.</p>
   <h2 class="heading settled" data-level="3" id="motivation"><span class="secno">3. </span><span class="content">Motivation</span><a class="self-link" href="#motivation"></a></h2>
   <h3 class="heading settled" data-level="3.1" id="atomic-operations-on-a-single-non-atomic-object"><span class="secno">3.1. </span><span class="content">Atomic Operations on a Single Non-atomic Object</span><a class="self-link" href="#atomic-operations-on-a-single-non-atomic-object"></a></h3>
   <p>An <em>atomic reference</em> is used to perform atomic operations on a referenced
non-atomic object.  The intent is for <em>atomic reference</em> to provide the
best-performing implementation of atomic operations for the non-atomic object
type.  All atomic operations performed through an <em>atomic reference</em> on a
referenced non-atomic object are atomic with respect to any other <em>atomic
reference</em> that references the same object, as defined by equality of pointers
to that object.  The intent is for atomic operations to directly update the
referenced object.  An <em>atomic reference constructor</em> might acquire a resource,
such as a lock from a collection of address-sharded locks, to perform atomic
operations.  Such <em>atomic reference</em> objects are not lock free and not address
free.  When such a resource is necessary, subsequent copy and move constructors
and assignment operators might reduce overhead by copying or moving the
previously acquired resource as opposed to re-acquiring that resource.</p>
   <p>Introducing concurrency within legacy codes might require replacing operations on
existing non-atomic objects with atomic operations such that the non-atomic
object cannot be replaced with an <em>atomic</em> object.</p>
   <p>An object could be heavily used non-atomically in well-defined phases of an
application.  Forcing such objects to be exclusively <em>atomic</em> would incur an
unnecessary performance penalty.</p>
   <h3 class="heading settled" data-level="3.2" id="atomic-operations-on-members-of-a-very-large-array"><span class="secno">3.2. </span><span class="content">Atomic Operations on Members of a Very Large Array</span><a class="self-link" href="#atomic-operations-on-members-of-a-very-large-array"></a></h3>
   <p>High-performance computing (HPC) applications use very large arrays.
Computations with these arrays typically have distinct phases that allocate and
initialize members of the array, update members of the array, and read members
of the array.  Parallel algorithms for initialization (e.g., zero fill) have
non-conflicting access when assigning member values.  Parallel algorithms for
updates have conflicting access to members which must be guarded by atomic
operations.  Parallel algorithms with read-only access require best-performing
streaming read access, random read access, vectorization, or other guaranteed
non-conflicting HPC pattern.</p>
   <h2 class="heading settled" data-level="4" id="reference-ability-constraints"><span class="secno">4. </span><span class="content"><em>Reference-ability</em> Constraints</span><a class="self-link" href="#reference-ability-constraints"></a></h2>
   <p>An object referenced by an <em>atomic reference</em> must satisfy possibly
architecture-specific constraints.  For example, the object might need to be
properly aligned in memory or might not be allowed to reside in GPU register
memory.  We do not enumerate all potential constraints or specify behavior when
these constraints are violated.  It is a quality-of-implementation issue to
generate appropriate information when constraints are violated.</p>
   <p><em>Note:</em> Whether an implementation of <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code> is lock free, does not
necessarily constrain whether the corresponding implementation of <code class="highlight"><span class="n">atomic_ref</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code> is lock free. <em>--end note</em></p>
   <h2 class="heading settled" data-level="5" id="concern-with-atomict-and-padding-bits-in-t"><span class="secno">5. </span><span class="content">Concern with <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code> and padding bits in <code class="highlight"><span class="n">T</span></code></span><a class="self-link" href="#concern-with-atomict-and-padding-bits-in-t"></a></h2>
    A concern has been discussed for <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code> where <code class="highlight"><span class="n">T</span></code> is a class type that
contains padding bits and how construction and <code class="highlight"><span class="n">compare_exchange</span></code> operations
are effected by the value of those padding bits.  We require that the
resolution of padding bits follow <span>[P0528r2]</span>. 
   <h2 class="heading settled" data-level="6" id="naming-atomic-reference-of-t"><span class="secno">6. </span><span class="content">Naming <em>atomic reference of T</em></span><a class="self-link" href="#naming-atomic-reference-of-t"></a></h2>
   <p>2018-03-15 Suggested that <em>atomic reference</em> of T be named <code class="highlight"><span class="n">atomic_ref</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code> instead of <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&amp;></span></code>?</p>
   <p>Result of SG1 poll</p>
   <table border="1">
    <tbody>
     <tr>
      <th>SF
      <th>F
      <th>N
      <th>A
      <th>SA
     <tr>
      <td>0 
      <td>7 
      <td>11 
      <td>3 
      <td>1 
   </table>
   <p>Those against <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&amp;></span></code> raised the concern that it allows dangerous
    errors to creep into generic code, which requires users to be aware of this
    edge case to avoid.  Also, after an <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code> is constructed it does not
    have data races with other objects, while an <em>atomic reference</em> of T does.
    Furthermore <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&amp;></span></code> does not have <em>volatile</em> member functions.
    Consequently, <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&amp;></span></code> is a specialization of <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code> with weaker
    guarantees.</p>
   <p>The arguments for <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&amp;></span></code> is that it is more concise and reduces the
    vocabulary terms that a user needs to know.</p>
   <p>We decided to keep the name of an <em>atomic reference</em> of T as <code class="highlight"><span class="n">atomic_ref</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code> for two reasons.  First, using the name <code class="highlight"><span class="n">atomic_ref</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code> removes any possibility of impacting existing generic code which uses <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code>.  Second, when trying to create wording for <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&amp;></span></code> the
    specializations had a distinct <code class="highlight"><span class="n">vector</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">></span></code> feel where each
    specialization needed to walk back from guarantees made by the primary
    template.  In particular, the <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&amp;></span></code> specializations would be unable
    to use the phrase <em>"Descriptions are provided below only for members that differ from the primary template"</em>.</p>
   <h2 class="heading settled" data-level="7" id="future-work"><span class="secno">7. </span><span class="content">Future Work</span><a class="self-link" href="#future-work"></a></h2>
   <ol>
    <li data-md="">
     <p>Rewrite <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code> in terms of <code class="highlight"><span class="n">atomic_ref</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code>?</p>
     <p>Result of SG1 poll</p>
     <table border="1">
      <tbody>
       <tr>
        <th>SF
        <th>F
        <th>N
        <th>A
        <th>SA
       <tr>
        <td>4 
        <td>3 
        <td>13 
        <td>0 
        <td>0 
     </table>
     <p><span>[P0019r8]</span> duplicates much of the wording of <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code> and it is
desirable to reduce this overhead.  However, rewriting <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code> would
require revisiting the contentious issue of <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code> having an exposition
only member of type <code class="highlight"><span class="n">T</span></code>.  While there is strong support for this rewrite in SG1
and LWG, we are limiting the scope of this paper to <em>atomic</em> <em>reference</em> to
reduce unnecessary conflicts.</p>
    <li data-md="">
     <p>The free functions and macros intended for C compatibility are deliberately
   omitted from this paper, but can be added if/when a need for them arises.</p>
   </ol>
   <h2 class="heading settled" data-level="8" id="proposal"><span class="secno">8. </span><span class="content">Proposal</span><a class="self-link" href="#proposal"></a></h2>
   <p>The proposed changes are relative to the working draft of the standard
as of <a data-link-type="biblio" href="#biblio-n4727">[N4727]</a>.</p>
   <blockquote>
     Text in blockquotes is not proposed wording 
    <p>The � character is used to denote a placeholder section number which the editor
shall determine.</p>
   </blockquote>
   <blockquote> [ <em>Note:</em> Most of the wording in this paper is duplicated from the wording for <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code>.  A future paper is needed to define <code class="highlight"><span class="n">atomic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code> in terms of <code class="highlight"><span class="n">atomic_ref</span><span class="o">&lt;</span><span class="n">T</span><span class="o">></span></code> and improve the current wording for <em>atomic objects</em>. 
--<em>end note</em>] </blockquote>
   <blockquote> Apply the following changes to 32.2.� [atomics.syn]: </blockquote>
<pre class="language-c++ highlight"><span class="n">namespace</span> <span class="n">std</span> <span class="p">{</span>

<span class="c1">// 3.� atomic ref</span>
<span class="c1"></span><span class="n">template</span><span class="o">&lt;</span><span class="n">class</span> <span class="n">T</span><span class="o">></span> <span class="k">struct</span> <span class="n">atomic_ref</span><span class="p">;</span>
<span class="c1">// 3.� atomic ref partial specialization for pointers</span>
<span class="c1"></span><span class="n">template</span><span class="o">&lt;</span><span class="n">class</span> <span class="n">T</span><span class="o">></span> <span class="k">struct</span> <span class="n">atomic_ref</span><span class="o">&lt;</span><span class="n">T</span> <span class="o">*></span><span class="p">;</span>

<span class="p">}</span>
</pre>
   <blockquote> Add a new subsection [atomics.ref.generic] before [atomics.types.generic] titled </blockquote>
   <p><strong>Class template atomic_ref</strong></p>
<pre class="language-c++ highlight"><span class="n"><span class="n">template</span></span><span class="o"><span class="o">&lt;</span></span><span class="n"><span class="n">class</span></span> <span class="n"><span class="n">T</span></span><span class="o"><span class="o">></span></span> <span class="k"><span class="k">struct</span></span> <span class="n"><span class="n">atomic_ref</span></span> <span class="p"><span class="p">{</span></span><span class="nl"></span>
<span class="c1"></span><span class="nl"><span class="nl">private</span></span><span class="p"><span class="p">:</span></span>
  <span class="n"><span class="n">T</span></span> <span class="o"><span class="o">*</span></span> <span class="n"><span class="n">ptr</span></span><span class="p"><span class="p">;</span></span> <span class="c1"><span class="c1">// exposition only</span></span>
<span class="c1"></span><span class="nl"><span class="c1"></span><span class="nl">public</span></span><span class="p"><span class="p">:</span></span>
  <span class="n"><span class="n">using</span></span> <span class="n"><span class="n">value_type</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">T</span></span><span class="p"><span class="p">;</span></span>
  <span class="k"><span class="k">static</span></span> <span class="n"><span class="n">constexpr</span></span> <span class="kt"><span class="kt">bool</span></span> <span class="n"><span class="n">is_always_lock_free</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><em><span class="n">implementation</span></em></span><span class="o"><span class="o">-</span></span><span class="n"><em><span class="n">defined</span></em></span><span class="p"><span class="p">;</span></span>
  <span class="k"><span class="k">static</span></span> <span class="n"><span class="n">constexpr</span></span> <span class="kt"><span class="kt">size_t</span></span> <span class="n"><span class="n">required_alignment</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><em><span class="n">implementation</span></em></span><span class="o"><span class="o">-</span></span><span class="n"><em><span class="n">defined</span></em></span><span class="p"><span class="p">;</span></span>

  <span class="n"><span class="n">atomic_ref</span></span><span class="p"><span class="p">()</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">delete</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">atomic_ref</span></span><span class="o"><span class="o">&amp;</span></span> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">=</span></span><span class="p"><span class="p">(</span></span><span class="k"><span class="k">const</span></span> <span class="n"><span class="n">atomic_ref</span></span><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">)</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">delete</span></span><span class="p"><span class="p">;</span></span>

  <span class="n"><span class="n">explicit</span></span> <span class="nf"><span class="nf">atomic_ref</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">T</span></span><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">);</span></span>
  <span class="n"><span class="n">atomic_ref</span></span><span class="p"><span class="p">(</span></span><span class="k"><span class="k">const</span></span> <span class="n"><span class="n">atomic_ref</span></span><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">);</span></span>

  <span class="n"><span class="n">T</span></span> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">=</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">T</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">operator</span></span> <span class="nf"><span class="nf">T</span></span><span class="p"><span class="p">()</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>

  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">is_lock_free</span></span><span class="p"><span class="p">()</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">void</span></span> <span class="nf"><span class="nf">store</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">T</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">T</span></span> <span class="nf"><span class="nf">load</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">T</span></span> <span class="nf"><span class="nf">exchange</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">T</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">compare_exchange_weak</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">T</span></span><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">T</span></span><span class="p"><span class="p">,</span></span> 
                             <span class="n"><span class="n">memory_order</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">memory_order</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">compare_exchange_strong</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">T</span></span><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">T</span></span><span class="p"><span class="p">,</span></span>
                               <span class="n"><span class="n">memory_order</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">memory_order</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">compare_exchange_weak</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">T</span></span><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">T</span></span><span class="p"><span class="p">,</span></span>
                             <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">compare_exchange_strong</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">T</span></span><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">T</span></span><span class="p"><span class="p">,</span></span>
                               <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
<span class="p"><span class="p">};</span></span>
</pre>
   <p>An <code class="highlight"><span class="n">atomic_ref</span></code> object applies atomic operations [atomics.general] to the object referenced by <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code> such that, for the lifetime [basic.life]
of the <code class="highlight"><span class="n">atomic_ref</span></code> object, the object referenced bi <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code> is an atomic object [intro.races].</p>
   <p>The template argument for <code class="highlight"><span class="n">T</span></code> shall be trivially copyable [basic.types].</p>
   <p>The specialization <code class="highlight"><span class="n">atomic_ref</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">></span></code> is a standard-layout struct.</p>
   <p>The lifetime [basic.life] of an object referenced by <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code> shall exceed the lifetime of all <code class="highlight"><span class="n">atomic_ref</span></code>s
that reference the object.  While any <code class="highlight"><span class="n">atomic_ref</span></code> instances exist which references the <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code> object all accesses that object shall exclusively occur
through those <code class="highlight"><span class="n">atomic_ref</span></code> instances. If the referenced object is of a class or 
aggregate type, then members of that object shall not be concurrently referenced
by any other <code class="highlight"><span class="n">atomic_ref</span></code> object.</p>
   <p>Atomic operations applied to an object through a referencing <code class="highlight"><span class="n">atomic_ref</span></code> are atomic with respect to atomic operations applied through any other <code class="highlight"><span class="n">atomic_ref</span></code> referencing the same object.</p>
   <p>[<em>Note</em>: Atomic operations or the <code class="highlight"><span class="n">atomic_ref</span></code> constructor could acquire a shared resource,
such as a lock associated with the referenced object, to enable atomic operations applied to
the referenced object. - <em>end note</em>]</p>
   <blockquote> Add a new subsubsection [atomics.ref.operations]
after [atomics.ref.generic] titled </blockquote>
   <p><strong>Operations on atomic types</strong></p>
   <p><strong>static constexpr bool is_always_lockfree;</strong></p>
   <p>The static data member <code class="highlight"><span class="n">is_always_lock_free</span></code> is true if the <code class="highlight"><span class="n">atomic_ref</span></code> type’s
  operations are always lock-free, and false otherwise.</p>
   <p><strong>static constexpr size_t required_alignment; </strong></p>
   <p>The required alignment of an object to be referenced by an atomic reference,
  which is at least <code class="highlight"><span class="k">alignof</span><span class="p">(</span><span class="n">T</span><span class="p">)</span></code>.</p>
   <p>[<em>Note:</em> Hardware could require that an object to be referenced
  by an <code class="highlight"><span class="n">atomic_ref</span></code> have stricter alignment [basic.align] than other objects
  of type <code class="highlight"><span class="n">T</span></code>.  Further, whether operations on an <code class="highlight"><span class="n">atomic_ref</span></code> are 
  lock-free could depend on the alignment of the referenced object.  For example,
  lock-free operations on <code class="highlight"><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">></span></code> could be supported
  only if aligned to <code class="highlight"><span class="mi">2</span><span class="o">*</span><span class="k">alignof</span><span class="p">(</span><span class="kt">double</span><span class="p">)</span></code>.  - <em>end note</em> ]</p>
   <p><strong>atomic_ref(T&amp; obj);</strong></p>
   <p><em>Requires:</em> The referenced object shall be aligned to <code class="highlight"><span class="n">required_alignment</span></code>.</p>
   <p><em>Effects:</em> Constructs an atomic reference that references the object.</p>
   <p><em>Throws:</em> Nothing.</p>
   <p><strong>atomic_ref(const atomic_ref&amp; ref);</strong></p>
   <p><em>Effects:</em> Construct an atomic reference that references the object referenced by <code class="highlight"><span class="n">ref</span></code>.</p>
   <p><strong>T operator=(T desired) const noexcept;</strong></p>
   <p><em>Effects:</em> Equivalent to: <code class="highlight"><span class="n">store</span><span class="p">(</span><span class="n">desired</span><span class="p">);</span> <span class="k">return</span> <span class="n">desired</span><span class="p">;</span></code></p>
   <p><strong>operator T() const noexcept;</strong></p>
   <p><em>Effects:</em> Equivalent to: <code class="highlight"><span class="k">return</span> <span class="nf">load</span><span class="p">();</span></code></p>
   <p><strong>bool is_lock_free() const noexcept;</strong></p>
   <p><em>Returns:</em> true if the object’s operations are lock-free, false otherwise.</p>
   <p><strong>void store(T desired, memory_order order = memory_order_seq_cst) const noexcept;</strong></p>
   <p><em>Requires:</em> The <code class="highlight"><span class="n">order</span></code> argument shall not be <code class="highlight"><span class="n">memory_order_consume</span></code>, <code class="highlight"><span class="n">memory_order_acquire</span></code>, nor <code class="highlight"><span class="n">memory_order_acq_rel</span></code>.</p>
   <p><em>Effects:</em> Atomically replaces the value referenced by <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code> with the value of <code class="highlight"><span class="n">desired</span></code>. Memory is affected according to the value of <code class="highlight"><span class="n">order</span></code>.</p>
   <p><strong>T load(memory_order order = memory_order_seq_cst) const noexcept; </strong></p>
   <p><em>Requires:</em> The <code class="highlight"><span class="n">order</span></code> argument shall not be <code class="highlight"><span class="n">memory_order_release</span></code> nor <code class="highlight"><span class="n">memory_order_acq_rel</span></code>.</p>
   <p><em>Effects:</em> Memory is affected according to the value of <code class="highlight"><span class="n">order</span></code>.</p>
   <p><em>Returns:</em> Atomically returns the value referenced by <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code>.</p>
   <p><strong>T exchange(T desired, memory_order order = memory_order_seq_cst) noexcept;</strong></p>
   <p><em>Effects:</em> Atomically replaces the value referenced by <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code> with <code class="highlight"><span class="n">desired</span></code>.
  Memory is affected according to the value of <code class="highlight"><span class="n">order</span></code>. These operations are
  atomic read-modify-write operations [intro.multithread].</p>
   <p>Returns: Atomically returns the value referenced by <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code> immediately before
  the effects.</p>
   <p><strong>bool compare_exchange_weak(T&amp; expected, T desired,
                           memory_order success, memory_order failure) const noexcept;</strong></p>
   <p><strong>bool compare_exchange_strong(T&amp; expected, T desired,
                             memory_order success, memory_order failure) const noexcept;</strong></p>
   <p><strong>bool compare_exchange_weak(T&amp; expected, T desired,
                           memory_order order = memory_order_seq_cst) const noexcept;</strong></p>
   <p><strong>bool compare_exchange_strong(T&amp; expected, T desired,
                             memory_order order = memory_order_seq_cst) const noexcept;</strong></p>
   <p><em>Requires:</em> The failure argument shall not be <code class="highlight"><span class="n">memory_order_release</span></code> nor <code class="highlight"><span class="n">memory_order_acq_rel</span></code>.</p>
   <p><em>Effects:</em> Retrieves the value in <code class="highlight"><span class="n">expected</span></code>. It then atomically compares the
  value referenced by <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code> for equality with that previously
  retrieved from <code class="highlight"><span class="n">expected</span></code>, and if true, replaces the value referenced by <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code> with that in <code class="highlight"><span class="n">desired</span></code>. If and only if the comparison is
  true, memory is affected according to the value of <code class="highlight"><span class="n">success</span></code>, and if the
  comparison is false, memory is affected according to the value of <code class="highlight"><span class="n">failure</span></code>.
  When only one <code class="highlight"><span class="n">memory_order</span></code> argument is supplied, the value of <code class="highlight"><span class="n">success</span></code> is <code class="highlight"><span class="n">order</span></code>, and the value of <code class="highlight"><span class="n">failure</span></code> is <code class="highlight"><span class="n">order</span></code> except that a value of <code class="highlight"><span class="n">memory_order_acq_rel</span></code> shall be replaced by the value <code class="highlight"><span class="n">memory_order_acquire</span></code> and a value of <code class="highlight"><span class="n">memory_order_release</span></code> shall be replaced by the value <code class="highlight"><span class="n">memory_order_relaxed</span></code>. If and only if the comparison is false then, after the
  atomic operation, the contents of the memory in <code class="highlight"><span class="n">expected</span></code> are replaced by the
  value read from the value referenced by <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code> during the atomic comparison.
  If the operation returns true, these operations are atomic read-modify-write
  operations [intro.races] on the value referenced by <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code>. Otherwise, these
  operations are atomic load operations on that memory.</p>
   <p><em>Returns:</em> The result of the comparison.</p>
   <p><em>Remarks:</em> A weak compare-and-exchange operation may fail spuriously. That is,
  even when the contents of memory referred to by expected and <code class="highlight"><span class="n">ptr</span></code> are equal,
  it may return false and store back to expected the same memory contents that
  were originally there. [ <em>Note:</em> This spurious failure enables implementation
  of compare-and-exchange on a broader class of machines, e.g., load-locked
  store-conditional machines. A consequence of spurious failure is that nearly
  all uses of weak compare-and-exchange will be in a loop. When a
  compare-and-exchange is in a loop, the weak version will yield better
  performance on some platforms. When a weak compare-and-exchange would require
  a loop and a strong one would not, the strong one is preferable. — end note ]</p>
   <blockquote> Add a new subsubsection [atomics.ref.int] following the [atomics.ref.operations]
subsubsection titled </blockquote>
   <p><strong>Specializations for integral types</strong></p>
   <p>There are specializations of the atomic template for the integral types <code class="highlight"><span class="kt">char</span></code>, <code class="highlight"><span class="kt">signed</span> <span class="kt">char</span></code>, <code class="highlight"><span class="kt">unsigned</span> <span class="kt">char</span></code>, <code class="highlight"><span class="kt">short</span></code>, <code class="highlight"><span class="kt">unsigned</span> <span class="kt">short</span></code>, <code class="highlight"><span class="kt">int</span></code>, <code class="highlight"><span class="kt">unsigned</span> <span class="kt">int</span></code>, <code class="highlight"><span class="kt">long</span></code>, <code class="highlight"><span class="kt">unsigned</span> <span class="kt">long</span></code>, <code class="highlight"><span class="kt">long</span> <span class="kt">long</span></code>, <code class="highlight"><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span></code>, <code class="highlight"><span class="kt">char16_t</span></code>, <code class="highlight"><span class="kt">char32_t</span></code>, <code class="highlight"><span class="kt">wchar_t</span></code>, and
any other types needed by the typedefs in the header <code class="highlight"><span class="o">&lt;</span><span class="n">cstdint</span><span class="o">></span></code>. For each such
integral type <strong><em>integral</em></strong>, the specialization <code class="highlight"><span class="n">atomic_ref</span><span class="o">&lt;</span><span class="n">integral</span><span class="o">></span></code> provides additional
atomic operations appropriate to integral types. [ <em>Note:</em> For the specialization <code class="highlight"><span class="n">atomic_ref</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">></span></code>, see [atomics.ref.generic]. — end note ]</p>
<pre class="language-c++ highlight"><span class="n"><span class="n">template</span></span><span class="o"><span class="o">&lt;></span></span> <span class="k"><span class="k">struct</span></span> <span class="n"><span class="n">atomic_ref</span></span><span class="o"><span class="o">&lt;</span></span><span class="n"><em><span class="n">integral</span></em></span><span class="o"><span class="o">></span></span> <span class="p"><span class="p">{</span></span><span class="nl"></span>
<span class="nl"><span class="nl">private</span></span><span class="p"><span class="p">:</span></span>
  <span class="n"><em><span class="n">integral</span></em></span><span class="o"><span class="o">*</span></span> <span class="n"><span class="n">ptr</span></span><span class="p"><span class="p">;</span></span> <span class="c1"><span class="c1">// exposition only</span></span>
<span class="c1"></span><span class="nl"><span class="c1"></span><span class="nl">public</span></span><span class="p"><span class="p">:</span></span>
  <span class="n"><span class="n">using</span></span> <span class="n"><span class="n">value_type</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><em><span class="n">integral</span></em></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">using</span></span> <span class="n"><span class="n">difference_type</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">value_type</span></span><span class="p"><span class="p">;</span></span>
  <span class="k"><span class="k">static</span></span> <span class="n"><span class="n">constexpr</span></span> <span class="kt"><span class="kt">bool</span></span> <span class="n"><span class="n">is_always_lock_free</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><em><span class="n">implementation</span></em></span><span class="o"><span class="o">-</span></span><span class="n"><em><span class="n">defined</span></em></span><span class="p"><span class="p">;</span></span>
  <span class="k"><span class="k">static</span></span> <span class="n"><span class="n">constexpr</span></span> <span class="kt"><span class="kt">size_t</span></span> <span class="n"><span class="n">required_alignment</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><em><span class="n">implementation</span></em></span><span class="o"><span class="o">-</span></span><span class="n"><em><span class="n">defined</span></em></span><span class="p"><span class="p">;</span></span>

  <span class="n"><span class="n">atomic_ref</span></span><span class="p"><span class="p">()</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">delete</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">atomic_ref</span></span><span class="o"><span class="o">&amp;</span></span> <span class="n"><span class="n">operator</span></span> <span class="o"><span class="o">=</span></span> <span class="p"><span class="p">(</span></span><span class="k"><span class="k">const</span></span> <span class="n"><span class="n">atomic_ref</span></span><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">)</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">delete</span></span><span class="p"><span class="p">;</span></span>

  <span class="n"><span class="n">explicit</span></span> <span class="nf"><span class="nf">atomic_ref</span></span><span class="p"><span class="p">(</span></span><span class="n"><em><span class="n">integral</span></em></span><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">);</span></span>
  <span class="n"><span class="n">atomic_ref</span></span><span class="p"><span class="p">(</span></span><span class="k"><span class="k">const</span></span> <span class="n"><span class="n">atomic_ref</span></span><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">);</span></span>

  <span class="n"><em><span class="n">integral</span></em></span> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">=</span></span><span class="p"><span class="p">(</span></span><span class="n"><em><span class="n">integral</span></em></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">operator</span></span> <span class="nf"><em><span class="nf">integral</span></em></span> <span class="p"><span class="p">()</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>

  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">is_lock_free</span></span><span class="p"><span class="p">()</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">void</span></span> <span class="nf"><span class="nf">store</span></span><span class="p"><span class="p">(</span></span><span class="n"><em><span class="n">integral</span></em></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><em><span class="n">integral</span></em></span> <span class="nf"><span class="nf">load</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><em><span class="n">integral</span></em></span> <span class="nf"><span class="nf">exchange</span></span><span class="p"><span class="p">(</span></span><span class="n"><em><span class="n">integral</span></em></span><span class="p"><span class="p">,</span></span>
                    <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">compare_exchange_weak</span></span><span class="p"><span class="p">(</span></span><span class="n"><em><span class="n">integral</span></em></span><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">,</span></span> <span class="n"><em><span class="n">integral</span></em></span><span class="p"><span class="p">,</span></span>
                             <span class="n"><span class="n">memory_order</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">memory_order</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">compare_exchange_strong</span></span><span class="p"><span class="p">(</span></span><span class="n"><em><span class="n">integral</span></em></span><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">,</span></span> <span class="n"><em><span class="n">integral</span></em></span><span class="p"><span class="p">,</span></span>
                               <span class="n"><span class="n">memory_order</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">memory_order</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">compare_exchange_weak</span></span><span class="p"><span class="p">(</span></span><span class="n"><em><span class="n">integral</span></em></span><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">,</span></span> <span class="n"><em><span class="n">integral</span></em></span><span class="p"><span class="p">,</span></span>
                             <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">compare_exchange_strong</span></span><span class="p"><span class="p">(</span></span><span class="n"><em><span class="n">integral</span></em></span><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">,</span></span> <span class="n"><em><span class="n">integral</span></em></span><span class="p"><span class="p">,</span></span>
                               <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>

  <span class="n"><em><span class="n">integral</span></em></span> <span class="nf"><span class="nf">fetch_add</span></span><span class="p"><span class="p">(</span></span><span class="n"><em><span class="n">integral</span></em></span><span class="p"><span class="p">,</span></span>
                     <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><em><span class="n">integral</span></em></span> <span class="nf"><span class="nf">fetch_sub</span></span><span class="p"><span class="p">(</span></span><span class="n"><em><span class="n">integral</span></em></span><span class="p"><span class="p">,</span></span>
                     <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><em><span class="n">integral</span></em></span> <span class="nf"><span class="nf">fetch_and</span></span><span class="p"><span class="p">(</span></span><span class="n"><em><span class="n">integral</span></em></span><span class="p"><span class="p">,</span></span>
                     <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><em><span class="n">integral</span></em></span> <span class="nf"><span class="nf">fetch_or</span></span><span class="p"><span class="p">(</span></span><span class="n"><em><span class="n">integral</span></em></span><span class="p"><span class="p">,</span></span>
                    <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><em><span class="n">integral</span></em></span> <span class="nf"><span class="nf">fetch_xor</span></span><span class="p"><span class="p">(</span></span><span class="n"><em><span class="n">integral</span></em></span><span class="p"><span class="p">,</span></span>
                     <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>

  <span class="n"><em><span class="n">integral</span></em></span> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">++</span></span><span class="p"><span class="p">(</span></span><span class="kt"><span class="kt">int</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><em><span class="n">integral</span></em></span> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">--</span></span><span class="p"><span class="p">(</span></span><span class="kt"><span class="kt">int</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><em><span class="n">integral</span></em></span> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">++</span></span><span class="p"><span class="p">()</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><em><span class="n">integral</span></em></span> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">--</span></span><span class="p"><span class="p">()</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><em><span class="n">integral</span></em></span> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">+=</span></span><span class="p"><span class="p">(</span></span><span class="n"><em><span class="n">integral</span></em></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><em><span class="n">integral</span></em></span> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">-=</span></span><span class="p"><span class="p">(</span></span><span class="n"><em><span class="n">integral</span></em></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><em><span class="n">integral</span></em></span> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">&amp;=</span></span><span class="p"><span class="p">(</span></span><span class="n"><em><span class="n">integral</span></em></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><em><span class="n">integral</span></em></span> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">|=</span></span><span class="p"><span class="p">(</span></span><span class="n"><em><span class="n">integral</span></em></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><em><span class="n">integral</span></em></span> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">^=</span></span><span class="p"><span class="p">(</span></span><span class="n"><em><span class="n">integral</span></em></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
<span class="p"><span class="p">};</span></span>
</pre>
   <p>Descriptions are provided below only for members that differ from the primary
template.</p>
   <p>The following operations perform arithmetic computations.  The key, operator, and
computation correspondence are identified in Table 130 [atomics.types.int].</p>
   <p><strong><em>integral</em> fetch_</strong><em>key</em><strong>(<em>integral</em> operand, memory_order order = memory_order_seq_cst) const noexcept;</strong></p>
   <p><em>Effects:</em> Atomically replaces the value referenced by <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code> with the result
  of the computation applied to the value referenced by <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code> and the given <code class="highlight"><span class="n">operand</span></code>. Memory is affected according to the value of <code class="highlight"><span class="n">order</span></code>. These operations
  are atomic read-modify-write operations [intro.races].</p>
   <p><em>Returns:</em> Atomically, the value referenced by <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code> immediately before the
  effects.</p>
   <p><em>Remarks:</em> For signed integer types, arithmetic is defined to use two’s
  complement representation. There are no undefined results.</p>
   <p><strong><em>integral</em> operator</strong> <em>op</em><strong>=(<em>integral</em> operand) const noexcept;</strong></p>
   <p><em>Effects:</em> Equivalent to: <code class="highlight"><span class="k"><span class="k">return</span></span> <span class="nf"><span class="nf">fetch_</span><strong><em><span class="nf">key</span></em></strong></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">operand</span></span><span class="p"><span class="p">)</span></span> <span class="n"><strong><em><span class="n">op</span></em></strong></span> <span class="n"><span class="n">operand</span></span><span class="p"><span class="p">;</span></span></code></p>
   <blockquote> Add a new subsubsection [atomics.ref.float] following the [atomics.ref.int]
subsubsection titled </blockquote>
   <p><strong>Specializations for floating-point types</strong></p>
   <p>There are specializations of the <code class="highlight"><span class="n">atomic_ref</span></code> template for the floating-point types <code class="highlight"><span class="kt">float</span></code>, <code class="highlight"><span class="kt">double</span></code>, and <code class="highlight"><span class="kt">long</span> <span class="kt">double</span></code>. For each such floating-point type <strong><em>floating-point</em></strong>, the specialization <code class="highlight"><span class="n">atomic_ref</span><span class="o">&lt;</span><span class="n">floating</span><span class="o">-</span><span class="n">point</span><span class="o">></span></code> provides additional
atomic operations appropriate to floating-point types.</p>
<pre class="language-c++ highlight"><span class="n"><span class="n">template</span></span><span class="o"><span class="o">&lt;></span></span> <span class="k"><span class="k">struct</span></span> <span class="n"><span class="n">atomic_ref</span></span><span class="o"><span class="o">&lt;</span></span><em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em><span class="o"><span class="o">></span></span> <span class="p"><span class="p">{</span></span><span class="nl"></span>
<span class="nl"><span class="nl">private</span></span><span class="p"><span class="p">:</span></span>
  <em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em><span class="o"><span class="o">*</span></span> <span class="n"><span class="n">ptr</span></span><span class="p"><span class="p">;</span></span> <span class="c1"><span class="c1">// exposition only</span></span>
<span class="c1"></span><span class="nl"><span class="c1"></span><span class="nl">public</span></span><span class="p"><span class="p">:</span></span>
  <span class="n"><span class="n">using</span></span> <span class="n"><span class="n">value_type</span></span> <span class="o"><span class="o">=</span></span> <em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">using</span></span> <span class="n"><span class="n">difference_type</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">value_type</span></span><span class="p"><span class="p">;</span></span>
  <span class="k"><span class="k">static</span></span> <span class="n"><span class="n">constexpr</span></span> <span class="kt"><span class="kt">bool</span></span> <span class="n"><span class="n">is_always_lock_free</span></span> <span class="o"><span class="o">=</span></span> <em><span class="n"><span class="n">implementation</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">defined</span></span></em><span class="p"><span class="p">;</span></span>
  <span class="k"><span class="k">static</span></span> <span class="n"><span class="n">constexpr</span></span> <span class="kt"><span class="kt">size_t</span></span> <span class="n"><span class="n">required_alignment</span></span> <span class="o"><span class="o">=</span></span> <em><span class="n"><span class="n">implementation</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">defined</span></span></em><span class="p"><span class="p">;</span></span>

  <span class="n"><span class="n">atomic_ref</span></span><span class="p"><span class="p">()</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">delete</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">atomic_ref</span></span><span class="o"><span class="o">&amp;</span></span> <span class="n"><span class="n">operator</span></span> <span class="o"><span class="o">=</span></span> <span class="p"><span class="p">(</span></span><span class="k"><span class="k">const</span></span> <span class="n"><span class="n">atomic_ref</span></span><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">)</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">delete</span></span><span class="p"><span class="p">;</span></span>

  <span class="n"><span class="n">explicit</span></span> <span class="nf"><span class="nf">atomic_ref</span></span><span class="p"><span class="p">(</span></span><em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">)</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">atomic_ref</span></span><span class="p"><span class="p">(</span></span><span class="k"><span class="k">const</span></span> <span class="n"><span class="n">atomic_ref</span></span><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">);</span></span>

  <em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">=</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span><span class="p"><span class="p">)</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">operator</span></span> <em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em> <span class="p"><span class="p">()</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>

  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">is_lock_free</span></span><span class="p"><span class="p">()</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">void</span></span> <span class="nf"><span class="nf">store</span></span><span class="p"><span class="p">(</span></span><em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em> <span class="n"><span class="n">load</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em> <span class="n"><span class="n">exchange</span></span><span class="p"><span class="p">(</span></span><em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em><span class="p"><span class="p">,</span></span>
                          <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">compare_exchange_weak</span></span><span class="p"><span class="p">(</span></span><em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">,</span></span> <em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em><span class="p"><span class="p">,</span></span>
                             <span class="n"><span class="n">memory_order</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">memory_order</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">compare_exchange_strong</span></span><span class="p"><span class="p">(</span></span><em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">,</span></span> <em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em><span class="p"><span class="p">,</span></span>
                               <span class="n"><span class="n">memory_order</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">memory_order</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">compare_exchange_weak</span></span><span class="p"><span class="p">(</span></span><em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">,</span></span> <em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em><span class="p"><span class="p">,</span></span>
                             <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">compare_exchange_strong</span></span><span class="p"><span class="p">(</span></span><em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">,</span></span> <em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em><span class="p"><span class="p">,</span></span>
                               <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>

  <em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em> <span class="n"><span class="n">fetch_add</span></span><span class="p"><span class="p">(</span></span><em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em><span class="p"><span class="p">,</span></span>
                           <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em> <span class="n"><span class="n">fetch_sub</span></span><span class="p"><span class="p">(</span></span><em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em><span class="p"><span class="p">,</span></span>
                           <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>

  <em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">+=</span></span><span class="p"><span class="p">(</span></span><em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">-=</span></span><span class="p"><span class="p">(</span></span><em><span class="n"><span class="n">floating</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">point</span></span></em><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
<span class="p"><span class="p">};</span></span>
</pre>
   <p>Descriptions are provided below only for members that differ from the primary
template.</p>
   <p>The following operations perform arithmetic computations.  The key, operator, and
computation correspondence are identified in Table 130 [atomics.types.int].</p>
   <p><strong><em>floating-point</em> fetch_</strong><em>key</em><strong>(<em>floating-point</em> operand, memory_order order = memory_order_seq_cst) const noexcept;</strong></p>
   <p><em>Effects:</em> Atomically replaces the value referenced by <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code> with the result
  of the computation applied to the value referenced by <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code> and the given <code class="highlight"><span class="n">operand</span></code>. Memory is affected according to the value of <code class="highlight"><span class="n">order</span></code>. These operations
  are atomic read-modify-write operations [intro.races].</p>
   <p><em>Returns:</em> Atomically, the value referenced by <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code> immediately before the
  effects.</p>
   <p><em>Remarks:</em> If the result is not a representable value for its type (8.1) the
  result is unspecified, but the operations otherwise have no undefined
  behavior. Atomic arithmetic operations on floating-point should conform to
  the std::numeric_limits<floating-point> traits associated with the floating-
  point type (21.3.2). The floating-point environment (29.4) for atomic
  arithmetic operations on floating-point may be different than the calling
  thread’s floating-point environment.</floating-point></p>
   <p><strong><em>floating-point</em> operator</strong> <em>op</em><strong>=(<em>floating-point</em> operand) const noexcept;</strong></p>
   <p><em>Effects:</em> Equivalent to: <code class="highlight"><span class="k"><span class="k">return</span></span> <span class="nf"><span class="nf">fetch_</span><strong><em><span class="nf">key</span></em></strong></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">operand</span></span><span class="p"><span class="p">)</span></span> <span class="n"><strong><em><span class="n">op</span></em></strong></span> <span class="n"><span class="n">operand</span></span><span class="p"><span class="p">;</span></span></code></p>
   <blockquote> Add a new subsubsection [atomics.ref.pointer] following the [atomics.ref.float]
subsubsection titled: </blockquote>
   <p><strong>Partial specialization for pointers</strong></p>
<pre class="language-c++ highlight"><span class="n"><span class="n">template</span></span><span class="o"><span class="o">&lt;</span></span><span class="n"><span class="n">class</span></span> <span class="n"><span class="n">T</span></span><span class="o"><span class="o">></span></span> <span class="k"><span class="k">struct</span></span> <span class="n"><span class="n">atomic_ref</span></span><span class="o"><span class="o">&lt;</span></span><span class="n"><span class="n">T</span></span><span class="o"><span class="o">*></span></span> <span class="p"><span class="p">{</span></span><span class="nl"></span>
<span class="nl"><span class="nl">private</span></span><span class="p"><span class="p">:</span></span>
  <span class="n"><span class="n">T</span></span><span class="o"><span class="o">**</span></span> <span class="n"><span class="n">ptr</span></span><span class="p"><span class="p">;</span></span> <span class="c1"><span class="c1">// exposition only</span></span>
<span class="c1"></span><span class="nl"><span class="c1"></span><span class="nl">public</span></span><span class="p"><span class="p">:</span></span>
  <span class="n"><span class="n">using</span></span> <span class="n"><span class="n">value_type</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">using</span></span> <span class="n"><span class="n">difference_type</span></span> <span class="o"><span class="o">=</span></span> <span class="kt"><span class="kt">ptrdiff_t</span></span><span class="p"><span class="p">;</span></span>
  <span class="k"><span class="k">static</span></span> <span class="n"><span class="n">constexpr</span></span> <span class="kt"><span class="kt">bool</span></span> <span class="n"><span class="n">is_always_lock_free</span></span> <span class="o"><span class="o">=</span></span> <em><span class="n"><span class="n">implementation</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">defined</span></span></em><span class="p"><span class="p">;</span></span>
  <span class="k"><span class="k">static</span></span> <span class="n"><span class="n">constexpr</span></span> <span class="kt"><span class="kt">size_t</span></span> <span class="n"><span class="n">required_alignment</span></span> <span class="o"><span class="o">=</span></span> <em><span class="n"><span class="n">implementation</span></span><span class="o"><span class="o">-</span></span><span class="n"><span class="n">defined</span></span></em><span class="p"><span class="p">;</span></span>

  <span class="n"><span class="n">atomic_ref</span></span><span class="p"><span class="p">()</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">delete</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">atomic_ref</span></span><span class="o"><span class="o">&amp;</span></span> <span class="n"><span class="n">operator</span></span> <span class="o"><span class="o">=</span></span> <span class="p"><span class="p">(</span></span><span class="k"><span class="k">const</span></span> <span class="n"><span class="n">atomic_ref</span></span><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">)</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">delete</span></span><span class="p"><span class="p">;</span></span>

  <span class="n"><span class="n">explicit</span></span> <span class="nf"><span class="nf">atomic_ref</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">T</span></span><span class="o"><span class="o">*&amp;</span></span><span class="p"><span class="p">);</span></span>
  <span class="n"><span class="n">atomic_ref</span></span><span class="p"><span class="p">(</span></span><span class="k"><span class="k">const</span></span> <span class="n"><span class="n">atomic_ref</span></span><span class="o"><span class="o">&amp;</span></span><span class="p"><span class="p">);</span></span>

  <span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">=</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">operator</span></span> <span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span> <span class="p"><span class="p">()</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>

  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">is_lock_free</span></span><span class="p"><span class="p">()</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">void</span></span> <span class="nf"><span class="nf">store</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span> <span class="nf"><span class="nf">load</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span> <span class="nf"><span class="nf">exchange</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">compare_exchange_weak</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">T</span></span><span class="o"><span class="o">*&amp;</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span><span class="p"><span class="p">,</span></span>
                             <span class="n"><span class="n">memory_order</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">memory_order</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">compare_exchange_strong</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">T</span></span><span class="o"><span class="o">*&amp;</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span><span class="p"><span class="p">,</span></span>
                               <span class="n"><span class="n">memory_order</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">memory_order</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">compare_exchange_weak</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">T</span></span><span class="o"><span class="o">*&amp;</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span><span class="p"><span class="p">,</span></span>
                             <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="kt"><span class="kt">bool</span></span> <span class="nf"><span class="nf">compare_exchange_strong</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">T</span></span><span class="o"><span class="o">*&amp;</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span><span class="p"><span class="p">,</span></span>
                               <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>

  <span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span> <span class="nf"><span class="nf">fetch_add</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">difference_type</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span> <span class="nf"><span class="nf">fetch_sub</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">difference_type</span></span><span class="p"><span class="p">,</span></span> <span class="n"><span class="n">memory_order</span></span> <span class="o"><span class="o">=</span></span> <span class="n"><span class="n">memory_order_seq_cst</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>

  <span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">++</span></span><span class="p"><span class="p">(</span></span><span class="kt"><span class="kt">int</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">--</span></span><span class="p"><span class="p">(</span></span><span class="kt"><span class="kt">int</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">++</span></span><span class="p"><span class="p">()</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">--</span></span><span class="p"><span class="p">()</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">+=</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">difference_type</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
  <span class="n"><span class="n">T</span></span><span class="o"><span class="o">*</span></span> <span class="n"><span class="n">operator</span></span><span class="o"><span class="o">-=</span></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">difference_type</span></span><span class="p"><span class="p">)</span></span> <span class="k"><span class="k">const</span></span> <span class="n"><span class="n">noexcept</span></span><span class="p"><span class="p">;</span></span>
<span class="p"><span class="p">};</span></span>
</pre>
   <p>Descriptions are provided below only for members that differ from the primary
template.</p>
   <p>The following operations perform arithmetic computations.  The key, operator, and
computation correspondence are identified in Table 130 [atomics.types.pointer].</p>
   <p><strong>T* fetch_</strong><em>key</em><strong>(difference_type operand, memory_order order = memory_order_seq_cst) const noexcept;</strong></p>
   <p><em>Requires:</em> T shall be an object type, otherwise the program is ill-formed</p>
   <p><em>Effects:</em> Atomically replaces the value referenced by <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code> with the result
  of the computation applied to the value referenced by <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code> and the given <code class="highlight"><span class="n">operand</span></code>. Memory is affected according to the value of <code class="highlight"><span class="n">order</span></code>. These operations
  are atomic read-modify-write operations [intro.races].</p>
   <p><em>Returns:</em> Atomically, the value referenced by <code class="highlight"><span class="o">*</span><span class="n">ptr</span></code> immediately before the
  effects.</p>
   <p><em>Remarks:</em> The result may be an undefined address, but the operations
  otherwise have no undefined behavior.</p>
   <p><strong>T* operator</strong> <em>op</em><strong>=(difference_type operand) const noexcept;</strong></p>
   <p><em>Effects:</em> Equivalent to: <code class="highlight"><span class="k"><span class="k">return</span></span> <span class="nf"><span class="nf">fetch_</span><strong><em><span class="nf">key</span></em></strong></span><span class="p"><span class="p">(</span></span><span class="n"><span class="n">operand</span></span><span class="p"><span class="p">)</span></span> <span class="n"><strong><em><span class="n">op</span></em></strong></span> <span class="n"><span class="n">operand</span></span><span class="p"><span class="p">;</span></span></code></p>
   <blockquote> Retitle subsubsection [atomics.types.memop] to </blockquote>
   <p><strong>Member operators common to atomic objects of integers and
pointers types</strong></p>
   <blockquote>
     and move to the subsection following the [atomics.types.generic] subsection. 
    <p>If possible rename the stable name to [atomics.objects.memberops].</p>
   </blockquote>
   <h2 class="heading settled" data-level="9" id="test"><span class="secno">9. </span><span class="content">Feature Testing</span><a class="self-link" href="#test"></a></h2>
   <p>The <code class="highlight"><span class="n">__cpp_lib_atomic_ref</span></code> feature test macro should be added.</p>
  </main>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">←</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">→</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">↑</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Don’t scroll to compensate for the ToC if we’re above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I don’t know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldn’t exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isn’t standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we don’t have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While we’re at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Can’t find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-n4727">[N4727]
   <dd>Richard Smith. <a href="https://wg21.link/n4727">Working Draft, Standard for Programming Language C++</a>. URL: <a href="https://wg21.link/n4727">https://wg21.link/n4727</a>
   <dt id="biblio-p0019r3">[P0019r3]
   <dd>H. Carter Edwards, Hans Boehm, Olivier Giroux, James Reus. <a href="https://wg21.link/p0019r3">Atomic View</a>. 14 October 2016. URL: <a href="https://wg21.link/p0019r3">https://wg21.link/p0019r3</a>
   <dt id="biblio-p0019r4">[P0019r4]
   <dd>H. Carter Edwards, Hans Boehm, Olivier Giroux, James Reus. <a href="https://wg21.link/p0019r4">Atomic View</a>. 9 November 2016. URL: <a href="https://wg21.link/p0019r4">https://wg21.link/p0019r4</a>
   <dt id="biblio-p0019r5">[P0019r5]
   <dd>H. Carter Edwards, Hans Boehm, Olivier Giroux, James Reus. <a href="https://wg21.link/p0019r5">Atomic View</a>. URL: <a href="https://wg21.link/p0019r5">https://wg21.link/p0019r5</a>
   <dt id="biblio-p0019r6">[P0019r6]
   <dd>H. Carter Edwards, Hans Boehm, Olivier Giroux, James Reus. <a href="https://wg21.link/p0019r6">Atomic View</a>. URL: <a href="https://wg21.link/p0019r6">https://wg21.link/p0019r6</a>
   <dt id="biblio-p0020r5">[P0020r5]
   <dd>H. Carter Edwards, Hans Boehm, Olivier Giroux, JF Bastien, James Reus. <a href="https://wg21.link/p0020r5">Floating Point Atomic</a>. URL: <a href="https://wg21.link/p0020r5">https://wg21.link/p0020r5</a>
   <dt id="biblio-p0558r1">[P0558r1]
   <dd><a href="https://wg21.link/p0558r1">Resolving atomic named base class inconsistencies</a>. URL: <a href="https://wg21.link/p0558r1">https://wg21.link/p0558r1</a>
  </dl>